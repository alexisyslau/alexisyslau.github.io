{% assign full = include.repository | strip %}

{% assign normalized = full
  | remove: "https://github.com/"
  | remove: "http://github.com/"
  | remove: "https://www.github.com/"
  | remove: "http://www.github.com/"
  | strip
%}

{% assign parts = normalized | split: "/" %}

{% if parts.size == 1 %}
  {% assign owner = site.github_username | strip %}
  {% assign repo_name = parts[0] | strip %}
{% else %}
  {% assign owner = parts[0] | strip %}
  {% assign repo_name = parts[1] | strip %}
{% endif %}

{% assign repo_full = owner | append: "/" | append: repo_name %}

{% assign lang = site.lang | default: "en" | split: "-" | first %}
{% assign max_lines = site.data.repositories.repo_description_lines_max | default: 2 %}

{% if site.data.repositories.github_users and site.data.repositories.github_users contains owner %}
  {% assign show_owner = false %}
{% else %}
  {% assign show_owner = true %}
{% endif %}

<!-- DEBUG repo_input='{{ include.repository }}' normalized='{{ normalized }}' owner='{{ owner }}' repo_name='{{ repo_name }}' repo_full='{{ repo_full }}' -->

<div class="repo p-2 text-center">
  <a href="https://github.com/{{ repo_full }}" target="_blank" rel="noopener">
    <img
      class="only-light w-100"
      alt="{{ repo_full }}"
      loading="lazy"
      src="https://github-stats-alexis.vercel.app/api/pin/?username={{ owner | uri_escape }}&repo={{ repo_name | uri_escape }}&theme={{ site.repo_theme_light }}&locale={{ lang }}&show_owner={{ show_owner }}&description_lines_count={{ max_lines }}"
    >
    <img
      class="only-dark w-100"
      alt="{{ repo_full }}"
      loading="lazy"
      src="https://github-stats-alexis.vercel.app/api/pin/?username={{ owner | uri_escape }}&repo={{ repo_name | uri_escape }}&theme={{ site.repo_theme_dark }}&locale={{ lang }}&show_owner={{ show_owner }}&description_lines_count={{ max_lines }}"
    >
  </a>
</div>